%**************************************************************************
%Programa para análise linear de estruturas reticuladas em regime elast.
%linear usando M.E.F. (ALERMEF)
%Autora: RAFAELA BERNARDES RABELO
%Versão de: 28/12/2020
%**************************************************************************

function [Kel] = ALERMEF_EP_RQ4_MatrizDeRigidezDoElemento(E,nu,t,tipoestr,...
    a,b)
%MATRIZ DE RIGIDEZ
Kel = zeros(8,8);
if strcmp(tipoestr,'EPD')
 E=E/(1-nu^2); nu= nu/(1-nu);
end
Kel(1,1) = (1/6)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(1,2) =-(1/8)*E/(-1+nu);
Kel(1,3) = (1/12)*E*(a^2*nu-a^2+4*b^2)/(a*(nu^2-1)*b);Kel(1,4) =-(1/8)*E*(3*nu-1)/(nu^2-1);
Kel(1,5) = -(1/12)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(1,6) =(1/8)*E/(-1+nu);
Kel(1,7) = -(1/6)*E*(a^2*nu-a^2+b^2)/(a*(nu^2-1)*b);Kel(1,8) =(1/8)*E*(3*nu-1)/(nu^2-1);
Kel(2,1) = -(1/8)*E/(-1+nu);Kel(2,2) = -(1/6)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(2,3) = (1/8)*E*(3*nu-1)/(nu^2-1);Kel(2,4) = -(1/6)*E*(b^2*nu+a^2-b^2)/(a*(nu^2-1)*b);
Kel(2,5) = (1/8)*E/(-1+nu);Kel(2,6) = (1/12)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(2,7) = -(1/8)*E*(3*nu-1)/(nu^2-1);Kel(2,8) = (1/12)*E*(b^2*nu+4*a^2-b^2)/(a*(nu^2-1)*b);
Kel(3,1) = (1/12)*E*(a^2*nu-a^2+4*b^2)/(a*(nu^2-1)*b);Kel(3,2) = (1/8)*E*(3*nu-1)/(nu^2-1);
Kel(3,3) = (1/6)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(3,4) = (1/8)*E/(-1+nu);
Kel(3,5) = -(1/6)*E*(a^2*nu-a^2+b^2)/(a*(nu^2-1)*b);Kel(3,6) = -(1/8)*E*(3*nu-1)/(nu^2-1);
Kel(3,7) = -(1/12)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(3,8) = -(1/8)*E/(-1+nu);
Kel(4,1) = -(1/8)*E*(3*nu-1)/(nu^2-1);Kel(4,2) = -(1/6)*E*(b^2*nu+a^2-b^2)/(a*(nu^2-1)*b);
Kel(4,3) = (1/8)*E/(-1+nu);Kel(4,4) = -(1/6)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(4,5) = (1/8)*E*(3*nu-1)/(nu^2-1);Kel(4,6) = (1/12)*E*(b^2*nu+4*a^2-b^2)/(a*(nu^2-1)*b);
Kel(4,7) = -(1/8)*E/(-1+nu);Kel(4,8) = (1/12)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(5,1) = -(1/12)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(5,2) = (1/8)*E/(-1+nu);
Kel(5,3) = -(1/6)*E*(a^2*nu-a^2+b^2)/(a*(nu^2-1)*b);Kel(5,4) = (1/8)*E*(3*nu-1)/(nu^2-1);
Kel(5,5) = (1/6)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(5,6) = -(1/8)*E/(-1+nu);
Kel(5,7) = (1/12)*E*(a^2*nu-a^2+4*b^2)/(a*(nu^2-1)*b);Kel(5,8) = -(1/8)*E*(3*nu-1)/(nu^2-1);
Kel(6,1) = (1/8)*E/(-1+nu);Kel(6,2) = (1/12)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(6,3) = -(1/8)*E*(3*nu-1)/(nu^2-1);Kel(6,4) = (1/12)*E*(b^2*nu+4*a^2-b^2)/(a*(nu^2-1)*b);
Kel(6,5) = -(1/8)*E/(-1+nu);Kel(6,6) = -(1/6)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(6,7) = (1/8)*E*(3*nu-1)/(nu^2-1);Kel(6,8) = -(1/6)*E*(b^2*nu+a^2-b^2)/(a*(nu^2-1)*b);
Kel(7,1) = -(1/6)*E*(a^2*nu-a^2+b^2)/(a*(nu^2-1)*b);Kel(7,2) = -(1/8)*E*(3*nu-1)/(nu^2-1);
Kel(7,3) = -(1/12)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(7,4) = -(1/8)*E/(-1+nu);
Kel(7,5) = (1/12)*E*(a^2*nu-a^2+4*b^2)/(a*(nu^2-1)*b);Kel(7,6) = (1/8)*E*(3*nu-1)/(nu^2-1);
Kel(7,7) = (1/6)*E*(a^2*nu-a^2-2*b^2)/(a*(nu^2-1)*b);Kel(7,8) = (1/8)*E/(-1+nu);
Kel(8,1) = (1/8)*E*(3*nu-1)/(nu^2-1);Kel(8,2) = (1/12)*E*(b^2*nu+4*a^2-b^2)/(a*(nu^2-1)*b);
Kel(8,3) = -(1/8)*E/(-1+nu);Kel(8,4) = (1/12)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel(8,5) = -(1/8)*E*(3*nu-1)/(nu^2-1);Kel(8,6) = -(1/6)*E*(b^2*nu+a^2-b^2)/(a*(nu^2-1)*b);
Kel(8,7) = (1/8)*E/(-1+nu);Kel(8,8) = -(1/6)*E*(-b^2*nu+2*a^2+b^2)/(a*(nu^2-1)*b);
Kel=t*Kel;
end

